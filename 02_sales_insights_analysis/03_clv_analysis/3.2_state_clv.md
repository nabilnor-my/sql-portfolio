# Task 3.2: Customer Lifetime Value by State

## ðŸ“Œ Goal
The goal of this task is to calculate and compare **Customer Lifetime Value (CLV)** across U.S. states.  
This provides insight into which **geographic segments** generate higher long-term value for the business.

---

## ðŸ“‚ Dataset
- **Source**:  
  - `bigquery-public-data.thelook_ecommerce.orders`  
  - `bigquery-public-data.thelook_ecommerce.order_items`  
  - `bigquery-public-data.thelook_ecommerce.users`  
- **Description**: Dataset includes order transactions, purchased items, and user demographics, restricted to **U.S. customers with completed orders**.

---

## ðŸ’» Queries Overview

### 1. Data Preparation
- Joined **orders**, **order items**, and **users**.  
- Filtered only for **completed U.S. orders**.  

### 2. User-Level Metrics
For each customer:
- **Revenue** = `SUM(sale_price)`  
- **Order Count** = `COUNT(DISTINCT order_id)`  
- **Lifespan** = `MAX(order_date) - MIN(order_date)` in months  

### 3. CLV Components
- **AOV (Average Order Value)** = Revenue Ã· Order Count  
- **Purchase Frequency** = Orders Ã· Lifespan (per month)  
- **CLV per User** = AOV Ã— Purchase Frequency Ã— Lifespan  

### 4. Aggregation by State
- Rolled up user-level CLV to **state segments**:
  - **Total Customers**  
  - **Total Revenue**  
  - **Average Revenue per Customer**  
  - **Average Orders per Customer**  
  - **Average CLV per Customer**  
  - **Total CLV (sum of individuals)**  

---

## ðŸ›  Skills Demonstrated
- **Multi-table joins** across orders, items, and users.  
- **Customer-level aggregation** before segmentation.  
- **CLV calculation formula** (AOV Ã— Frequency Ã— Lifespan).  
- **Segmentation** at the state level.  
- **Aggregated KPIs**: both total and average metrics.  

---

## ðŸ“Š Results

| State | Customers | State Revenue | Avg Revenue per Customer | Avg Orders per Customer | Avg CLV per Customer | Total CLV |
|-------|-----------|---------------|--------------------------|--------------------------|----------------------|-----------|
| NY    | 1,056     | \$114,872     | \$108.76                 | 1.15                     | 22.1                 | 23,337.6  |
| CA    | 986       | \$109,452     | \$111.00                 | 1.14                     | 21.8                 | 21,514.8  |
| TX    | 972       | \$96,783      | \$99.57                  | 1.12                     | 19.9                 | 19,342.8  |
| FL    | 945       | \$88,326      | \$93.48                  | 1.11                     | 19.2                 | 18,144.0  |
| IL    | 912       | \$87,423      | \$95.87                  | 1.10                     | 18.7                 | 17,054.4  |

---

## ðŸ”— Insights
- **Top Revenue States**: New York and California lead in **total CLV** (\$23.3k and \$21.5k respectively).  
- **High Value Customers**: California has the **highest average revenue per customer** (\$111).  
- **Midwest Opportunity**: Illinois shows solid revenue but slightly lower CLV per customer compared to coastal states.  
- **Strategic Takeaway**:
  - Focus marketing spend on **New York and California** for **maximum ROI**.
  - Designing **growth initiatives** for Texas and Florida where customer bases are large but CLV is lower.
